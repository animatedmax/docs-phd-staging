<!doctype html>
<html>
<head>
  <meta charset="utf-8">

  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <!-- Use title if it's in the page YAML frontmatter -->
  <title>Upgrade Instructions - 1.1.1 to 2.1.0 | Pivotal HD Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link href="stylesheets/master.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
  <link href='http://www.pivotal.io/misc/favicon.ico' rel='shortcut icon'>
  <script src="javascripts/all.js" type="text/javascript"></script>
  
  <script type="text/javascript">
    if (window.location.host === 'docs.pivotal.io') {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-39702075-1']);
      _gaq.push(['_setDomainName', 'pivotal.io']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    }
  </script>
  <!-- Confluence HTML stylesheet -->
   <link href="stylesheets/site-conf.css" media="screen,print" rel="stylesheet"  type="text/css" /> 
   
   <!-- Left-navigation code -->
    <link href="stylesheets/dcaccordion.css" rel="stylesheet" type="text/css" />
    <!--End left-navigation code -->
   
</head>

<body class="pivotalhd pivotalhd_getstarted pivotalhd_getstarted_phd-docs has-subnav">

<div class="viewport">
<div class='wrap'>
  <script src="//use.typekit.net/clb0qji.js" type="text/javascript"></script>
  <script type="text/javascript">
      try {
          Typekit.load();
      } catch (e) {
      }
  </script>
  <script type="text/javascript">
      document.domain = "pivotal.io";
  </script>

  <script type="text/javascript">
    WebFontConfig = {
      google: { families: [ 'Source+Sans+Pro:300italic,400italic,300,400,600:latin' ] }
    };
    (function() {
      var wf = document.createElement('script');
      wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
        '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
      wf.type = 'text/javascript';
      wf.async = 'true';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(wf, s);
    })();
  </script>
   
    <header class="header header-layout">
      <h1 class="logo">
        <a href="index.html">Pivotal HD Documentation</a> v2.1.0
      </h1>
      <div class="header-links js-bar-links">
        <div class="btn-menu" data-behavior="MenuMobile"></div>
        <div class="header-item">
          <a href="http://docs.pivotal.io">Docs Home</a>
        </div>
        <div class="header-item">
          <a href="http://support.pivotal.io" target="_blank">Support</a>
        </div>
        <div class="header-item searchbar js-searchbar">
          <a class="search-icon" data-behavior="Search"></a>
          <div class="search-input">
            <!-- Google CSE Search Box -->
            <div class="search-input-inner" id="docs-search">
                <gcse:search></gcse:search>
            </div>
          </div>
        </div>
      </div>
    </header>
    
    <div class="container">
    
	<!--INSERT SIDENAV -->
	<div id="sub-nav" class="nav-container">

         <p class="productname"><a href="PivotalHD.html">Pivotal HD</a></p>
         <ul>
            <li>
               <a href="PHDEnterprise2.1.0ReleaseNotes.html">PHD Enterprise 2.1.0 Release Notes</a>
            </li>
            <li>
               <a href="PHDInstallationandAdministration.html">PHD Installation and Administration</a>
               <ul>
                  <li>
                     <a href="OverviewofPHD.html">Overview of PHD</a>
                  </li>
                  <li>
                     <a href="InstallationOverview.html">Installation Overview</a>
                     <ul>
                        <li>
                           <a href="CommandLineInstallationFeatures.html">Command Line Installation Features</a>
                        </li>
                        <li>
                           <a href="DeploymentOptions.html">Deployment Options</a>
                        </li>
                        <li>
                           <a href="PlanningyourPHDClusterDeployment.html">Planning your PHD Cluster Deployment</a>
                        </li>
                        <li>
                           <a href="BestPracticesforSelectingHardware.html">Best Practices for Selecting Hardware</a>
                        </li>
                        <li>
                           <a href="BestPracticesforDeployingHadoopServices.html">Best Practices for Deploying Hadoop Services</a>
                        </li>
                        <li>
                           <a href="HighAvailabilityBestPractices.html">High Availability Best Practices</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="PHDInstallationPrerequisites.html">PHD Installation Prerequisites</a>
                     <ul>
                        <li>
                           <a href="BeforeYouBeginInstallingPHD.html">Before You Begin Installing PHD</a>
                        </li>
                        <li>
                           <a href="PHDPrerequisiteChecklist.html">PHD Prerequisite Checklist</a>
                        </li>
                        <li>
                           <a href="PHD-DNSLookup.html">PHD - DNS Lookup</a>
                        </li>
                        <li>
                           <a href="PHD-JAVAJDK.html">PHD - JAVA JDK</a>
                        </li>
                        <li>
                           <a href="PHD-VerifyPackageAccessibility.html">PHD - Verify Package Accessibility</a>
                        </li>
                        <li>
                           <a href="PHD-TurnOffiptables.html">PHD - Turn Off iptables</a>
                        </li>
                        <li>
                           <a href="PHD-DisableSELinux.html">PHD - Disable SELinux</a>
                        </li>
                        <li>
                           <a href="EPELYumRepository.html">EPEL Yum Repository</a>
                        </li>
                        <li>
                           <a href="SudoConfigurationFiles.html">Sudo Configuration Files</a>
                        </li>
                        <li>
                           <a href="FQDN.html">FQDN</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="InstallingPHDUsingtheCLI.html">Installing PHD Using the CLI</a>
                     <ul>
                        <li>
                           <a href="PHDInstallationChecklist.html">PHD Installation Checklist</a>
                        </li>
                        <li>
                           <a href="InstallingPivotalCommandCenter.html">Installing Pivotal Command Center</a>
                        </li>
                        <li>
                           <a href="ConfiguringKerberosandLDAP.html">Configuring Kerberos and LDAP</a>
                        </li>
                        <li>
                           <a href="PHD-ImportingthePackages.html">PHD - Importing the Packages</a>
                        </li>
                        <li>
                           <a href="EditingtheClusterConfigurationFiles.html">Editing the Cluster Configuration Files</a>
                        </li>
                        <li>
                           <a href="EditingtheHAWQConfigurationFile.html">Editing the HAWQ Configuration File</a>
                        </li>
                        <li>
                           <a href="ForPXFwithGemFireXD.html">For PXF with GemFire XD</a>
                        </li>
                        <li>
                           <a href="DeployingtheCluster.html">Deploying the Cluster</a>
                        </li>
                        <li>
                           <a href="StartingtheCluster.html">Starting the Cluster</a>
                        </li>
                        <li>
                           <a href="InitializingandStartingHAWQ.html">Initializing and Starting HAWQ</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="PHDPost-Installation.html">PHD Post-Installation</a>
                     <ul>
                        <li>
                           <a href="VerifyingPHDServiceStatus.html">Verifying PHD Service Status</a>
                        </li>
                        <li>
                           <a href="RunningPHDSamplePrograms.html">Running PHD Sample Programs</a>
                        </li>
                        <li>
                           <a href="Post-InstallationReferenceInformation.html">Post-Installation Reference Information</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="PHDUpgradePrerequisites.html">PHD Upgrade Prerequisites</a>
                     <ul>
                        <li>
                           <a href="UpgradePrerequisiteChecklist.html">Upgrade Prerequisite Checklist</a>
                        </li>
                        <li>
                           <a href="FileLocationsandBackups.html">File Locations and Backups</a>
                        </li>
                        <li>
                           <a href="VerifyJavaJDK.html">Verify Java JDK</a>
                        </li>
                        <li>
                           <a href="CompactHBaseTables.html">Compact HBase Tables</a>
                        </li>
                        <li>
                           <a href="SudoConfigurationFile.html">Sudo Configuration File</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="UpgradingPHD2.0.xto2.1.0.html">Upgrading PHD 2.0.x to 2.1.0</a>
                     <ul>
                        <li>
                           <a href="PHDUpgradeChecklist-2.0.xto2.1.0.html">PHD Upgrade Checklist - 2.0.x to 2.1.0</a>
                        </li>
                        <li>
                           <a href="UpgradeInstructions-2.0.xto2.1.0.html">Upgrade Instructions - 2.0.x to 2.1.0</a>
                        </li>
                        <li>
                           <a href="MovingHAWQFilespacetoHA-enabledHDFS-2.0.xto2.1.0.html">Moving HAWQ Filespace to HA-enabled HDFS - 2.0.x to 2.1.0</a>
                        </li>
                        <li>
                           <a href="UpgradeReferenceInformation-2.0.xto2.1.0.html">Upgrade Reference Information - 2.0.x to 2.1.0</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="UpgradingPHDfrom1.1.1to2.1.0.html">Upgrading PHD from 1.1.1 to 2.1.0</a>
                     <ul>
                        <li>
                           <a href="UpgradeChecklist-1.1.1to2.1.0.html">Upgrade Checklist - 1.1.1 to 2.1.0</a>
                        </li>
                        <li>
                           <a href="UpgradeInstructions-1.1.1to2.1.0.html">Upgrade Instructions - 1.1.1 to 2.1.0</a>
                        </li>
                        <li>
                           <a href="MovingHAWQFilespacetoHA-enabledHDFS-1.1.1to2.1.0.html">Moving HAWQ Filespace to HA-enabled HDFS - 1.1.1 to 2.1.0</a>
                        </li>
                        <li>
                           <a href="UpgradeReferenceInformation-1.1.1to2.1.0.html">Upgrade Reference Information - 1.1.1 to 2.1.0</a>
                        </li>
                        <li>
                           <a href="DisablingSecurityona1.1.1Cluster.html">Disabling Security on a 1.1.1 Cluster</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="AdministeringPHDUsingtheCLI.html">Administering PHD Using the CLI</a>
                     <ul>
                        <li>
                           <a href="ManagingaPHDCluster.html">Managing a PHD Cluster</a>
                           <ul>
                              <li>
                                 <a href="StartingaCluster.html">Starting a Cluster</a>
                              </li>
                              <li>
                                 <a href="StoppingaCluster.html">Stopping a Cluster</a>
                              </li>
                              <li>
                                 <a href="RestartingaCluster.html">Restarting a Cluster</a>
                              </li>
                              <li>
                                 <a href="ReconfiguringaCluster.html">Reconfiguring a Cluster</a>
                              </li>
                              <li>
                                 <a href="AddingRemovingServices.html">Adding/Removing Services</a>
                              </li>
                              <li>
                                 <a href="AddingHoststoaCluster.html">Adding Hosts to a Cluster</a>
                              </li>
                              <li>
                                 <a href="RetrievingInformationaboutaDeployedCluster.html">Retrieving Information about a Deployed Cluster</a>
                              </li>
                              <li>
                                 <a href="ListingClusters.html">Listing Clusters</a>
                              </li>
                              <li>
                                 <a href="ExpandingaCluster.html">Expanding a Cluster</a>
                              </li>
                              <li>
                                 <a href="ShrinkingaCluster.html">Shrinking a Cluster</a>
                              </li>
                              <li>
                                 <a href="DecommissioningSlaveNodes.html">Decommissioning Slave Nodes</a>
                                 <ul>
                                    <li>
                                       <a href="DecommissionNodesOverview.html">Decommission Nodes Overview</a>
                                    </li>
                                    <li>
                                       <a href="DecommissioningtheDataNode.html">Decommissioning the Data Node</a>
                                    </li>
                                    <li>
                                       <a href="DecommissioningtheYARNNodeManager.html">Decommissioning the YARN NodeManager</a>
                                    </li>
                                    <li>
                                       <a href="ShuttingDowntheSlaveNode.html">Shutting Down the Slave Node</a>
                                    </li>
                                    <li>
                                       <a href="ReplacingtheSlaveNode.html">Replacing the Slave Node</a>
                                    </li>
                                    <li>
                                       <a href="ReplacingtheSlaveNodeDisk.html">Replacing the Slave Node Disk</a>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <a href="HighAvailability.html">High Availability</a>
                                 <ul>
                                    <li>
                                       <a href="DisablingHighAvailability.html">Disabling High Availability</a>
                                    </li>
                                    <li>
                                       <a href="EnablingRe-enablingHighAvailability.html">Enabling/Re-enabling High Availability</a>
                                    </li>
                                    <li>
                                       <a href="HighAvailabilityCommandReference.html">High Availability Command Reference</a>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <a href="SecurityKerberosAuthentication.html">Security/Kerberos Authentication</a>
                                 <ul>
                                    <li>
                                       <a href="EnablingKerberosAuthentication.html">Enabling Kerberos Authentication</a>
                                    </li>
                                    <li>
                                       <a href="DisablingKerberosAuthentication.html">Disabling Kerberos Authentication</a>
                                    </li>
                                    <li>
                                       <a href="SecureModeCommands.html">Secure Mode Commands</a>
                                    </li>
                                 </ul>
                              </li>
                              <li>
                                 <a href="UninstallingaCluster.html">Uninstalling a Cluster</a>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <a href="ManagingHAWQ.html">Managing HAWQ</a>
                           <ul>
                              <li>
                                 <a href="InitializingHAWQ.html">Initializing HAWQ</a>
                              </li>
                              <li>
                                 <a href="StartingHAWQ.html">Starting HAWQ</a>
                              </li>
                              <li>
                                 <a href="StoppingHAWQ.html">Stopping HAWQ</a>
                              </li>
                              <li>
                                 <a href="ModifyingHAWQUserConfiguration.html">Modifying HAWQ User Configuration</a>
                              </li>
                              <li>
                                 <a href="ExpandingHAWQ.html">Expanding HAWQ</a>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <a href="ManagingPHDRolesandHosts.html">Managing PHD Roles and Hosts</a>
                        </li>
                        <li>
                           <a href="PHDServicesReference.html">PHD Services Reference</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="PHDFAQ-FrequentlyAskedQuestions.html">PHD FAQ - Frequently Asked Questions</a>
                  </li>
                  <li>
                     <a href="PHDTroubleshooting.html">PHD Troubleshooting</a>
                  </li>
                  <li>
                     <a href="PHDRESTAPIs.html">PHD REST APIs</a>
                     <ul>
                        <li>
                           <a href="SwaggerwithOAuth.html">Swagger with OAuth</a>
                        </li>
                        <li>
                           <a href="ListofPHDRESTAPIs.html">List of PHD REST APIs</a>
                        </li>
                     </ul>
                  </li>
               </ul>
            </li>
            <li>
               <a href="StackandToolsReference.html">Stack and Tools Reference</a>
               <ul>
                  <li>
                     <a href="OverviewofApacheStackandPivotalComponents.html">Overview of Apache Stack and Pivotal Components</a>
                  </li>
                  <li>
                     <a href="ManuallyInstallingandUsingPivotalHD2.1Stack.html">Manually Installing and Using Pivotal HD 2.1 Stack</a>
                     <ul>
                        <li>
                           <a href="DistributionContents.html">Distribution Contents</a>
                        </li>
                        <li>
                           <a href="ApacheConfigurationReference.html">Apache Configuration Reference</a>
                        </li>
                        <li>
                           <a href="AccessingPHD2.1.html">Accessing PHD 2.1</a>
                        </li>
                        <li>
                           <a href="HadoopHDFS.html">Hadoop HDFS</a>
                        </li>
                        <li>
                           <a href="HadoopYARN.html">Hadoop YARN</a>
                        </li>
                        <li>
                           <a href="HadoopPseudo-distributedConfiguration.html">Hadoop Pseudo-distributed Configuration</a>
                        </li>
                        <li>
                           <a href="Zookeeper.html">Zookeeper</a>
                        </li>
                        <li>
                           <a href="HBase.html">HBase</a>
                        </li>
                        <li>
                           <a href="Hive.html">Hive</a>
                        </li>
                        <li>
                           <a href="HCatalog.html">HCatalog</a>
                        </li>
                        <li>
                           <a href="Pig.html">Pig</a>
                        </li>
                        <li>
                           <a href="Mahout.html">Mahout</a>
                        </li>
                        <li>
                           <a href="Flume.html">Flume</a>
                        </li>
                        <li>
                           <a href="Sqoop.html">Sqoop</a>
                        </li>
                        <li>
                           <a href="Oozie.html">Oozie</a>
                        </li>
                        <li>
                           <a href="GraphLab.html">GraphLab</a>
                        </li>
                        <li>
                           <a href="Hamster.html">Hamster</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="ManuallyUpgradingPivotalHDStacktoPHD2.1.html">Manually Upgrading Pivotal HD Stack to PHD 2.1</a>
                  </li>
                  <li>
                     <a href="PivotalHadoopEnhancements.html">Pivotal Hadoop Enhancements</a>
                  </li>
                  <li>
                     <a href="Security.html">Security</a>
                     <ul>
                        <li>
                           <a href="SecurityOverview.html">Security Overview</a>
                        </li>
                        <li>
                           <a href="KerberosSetup.html">Kerberos Setup</a>
                        </li>
                        <li>
                           <a href="LDAPSetup.html">LDAP Setup</a>
                        </li>
                        <li>
                           <a href="ConfiguringKerberosforHDFSandYARNMapReduce.html">Configuring Kerberos for HDFS and YARN (MapReduce)</a>
                        </li>
                        <li>
                           <a href="ConfiguringKerberosforHDFSHighAvailability.html">Configuring Kerberos for HDFS High Availability</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureZookeeper.html">Configuring Secure Zookeeper</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureHBase.html">Configuring Secure HBase</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureHive.html">Configuring Secure Hive</a>
                        </li>
                        <li>
                           <a href="ConfiguringHCatalogWebHCatonSecureHive.html">Configuring HCatalog (WebHCat) on Secure Hive</a>
                        </li>
                        <li>
                           <a href="ConfiguringHAWQonSecureHDFS.html">Configuring HAWQ on Secure HDFS</a>
                        </li>
                        <li>
                           <a href="EnablingAuditing.html">Enabling Auditing</a>
                        </li>
                        <li>
                           <a href="SecureWebAccess.html">Secure Web Access</a>
                        </li>
                        <li>
                           <a href="SecureWebAccessviaHttpFS.html">Secure Web Access via HttpFS</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureFlume.html">Configuring Secure Flume</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureOozie.html">Configuring Secure Oozie</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureSqoop.html">Configuring Secure Sqoop</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecurePig.html">Configuring Secure Pig</a>
                        </li>
                        <li>
                           <a href="ConfiguringSecureMahout.html">Configuring Secure Mahout</a>
                        </li>
                        <li>
                           <a href="Security-Troubleshooting.html">Security - Troubleshooting</a>
                        </li>
                     </ul>
                  </li>
               </ul>
            </li>
         </ul>

         <p class="productname"><a href="PivotalCommandCenter.html">Pivotal Command Center</a></p>
         <ul>
            <li>
               <a href="PCC2.3.0ReleaseNotes.html">PCC 2.3.0 Release Notes</a>
            </li>
            <li>
               <a href="PCCUserGuide.html">PCC User Guide</a>
               <ul>
                  <li>
                     <a href="PCCOverview.html">PCC Overview</a>
                  </li>
                  <li>
                     <a href="PCCInstallationPrerequisites.html">PCC Installation Prerequisites</a>
                     <ul>
                        <li>
                           <a href="BeforeYouBeginInstallingPCC.html">Before You Begin Installing PCC</a>
                        </li>
                        <li>
                           <a href="PCCPrerequisiteChecklist.html">PCC Prerequisite Checklist</a>
                        </li>
                        <li>
                           <a href="PCC-DNSLookup.html">PCC - DNS Lookup</a>
                        </li>
                        <li>
                           <a href="PCC-JAVAJDK.html">PCC - JAVA JDK</a>
                        </li>
                        <li>
                           <a href="PCC-VerifyPackageAccessibility.html">PCC - Verify Package Accessibility</a>
                        </li>
                        <li>
                           <a href="PCC-TurnOffiptables.html">PCC - Turn Off iptables</a>
                        </li>
                        <li>
                           <a href="PCC-DisableSELinux.html">PCC - Disable SELinux</a>
                        </li>
                        <li>
                           <a href="PCC-EPELYumRepository.html">PCC - EPEL Yum Repository</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="InstallationInstructions.html">Installation Instructions</a>
                     <ul>
                        <li>
                           <a href="SupportedPlatformsandBrowsers.html">Supported Platforms and Browsers</a>
                        </li>
                        <li>
                           <a href="PCCInstallationChecklist.html">PCC Installation Checklist</a>
                        </li>
                        <li>
                           <a href="InstallPCC.html">Install PCC</a>
                        </li>
                        <li>
                           <a href="PCC-ImportingthePackages.html">PCC - Importing the Packages</a>
                        </li>
                        <li>
                           <a href="LaunchingPCC.html">Launching PCC</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="UninstallingPCC.html">Uninstalling PCC</a>
                  </li>
                  <li>
                     <a href="UpgradingPCC.html">Upgrading PCC</a>
                  </li>
                  <li>
                     <a href="UsingPCC.html">Using PCC</a>
                     <ul>
                        <li>
                           <a href="PCCUIOverview.html">PCC UI Overview</a>
                        </li>
                        <li>
                           <a href="LoggingIn.html">Logging In</a>
                        </li>
                        <li>
                           <a href="PCCUISettings.html">PCC UI Settings</a>
                        </li>
                        <li>
                           <a href="PCCUIUserManagement.html">PCC UI User Management</a>
                        </li>
                        <li>
                           <a href="ClusterStatusPage.html">Cluster Status Page</a>
                        </li>
                        <li>
                           <a href="ConfiguringandDeployingaCluster.html">Configuring and Deploying a Cluster</a>
                           <ul>
                              <li>
                                 <a href="LaunchingtheAddClusterWizard.html">Launching the Add Cluster Wizard</a>
                              </li>
                              <li>
                                 <a href="CreateClusterDefinition.html">Create Cluster Definition</a>
                              </li>
                              <li>
                                 <a href="VersionsServicesandHosts.html">Versions, Services, and Hosts</a>
                              </li>
                              <li>
                                 <a href="HostVerification.html">Host Verification</a>
                              </li>
                              <li>
                                 <a href="ClusterTopology.html">Cluster Topology</a>
                              </li>
                              <li>
                                 <a href="ClusterConfiguration.html">Cluster Configuration</a>
                              </li>
                              <li>
                                 <a href="Validation.html">Validation</a>
                              </li>
                              <li>
                                 <a href="DeploymentStatus.html">Deployment Status</a>
                              </li>
                              <li>
                                 <a href="Summary.html">Summary</a>
                              </li>
                              <li>
                                 <a href="StartingtheClusterfromtheUI.html">Starting the Cluster from the UI</a>
                              </li>
                              <li>
                                 <a href="InitializingandConfiguringHAWQ.html">Initializing and Configuring HAWQ</a>
                              </li>
                           </ul>
                        </li>
                        <li>
                           <a href="StartingStoppingandUninstallingaCluster.html">Starting, Stopping, and Uninstalling a Cluster</a>
                        </li>
                        <li>
                           <a href="PCCUIDashboard.html">PCC UI Dashboard</a>
                        </li>
                        <li>
                           <a href="ClusterAnalysis.html">Cluster Analysis</a>
                        </li>
                        <li>
                           <a href="MapReduceJobMonitor.html">MapReduce Job Monitor</a>
                        </li>
                        <li>
                           <a href="YarnAppMonitor.html">Yarn App Monitor</a>
                        </li>
                        <li>
                           <a href="HAWQQueryMonitor.html">HAWQ Query Monitor</a>
                        </li>
                        <li>
                           <a href="Topology.html">Topology</a>
                        </li>
                        <li>
                           <a href="Logs.html">Logs</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="ConfiguringPCCforLDAP.html">Configuring PCC for LDAP</a>
                  </li>
                  <li>
                     <a href="CommandLineReference.html">Command Line Reference</a>
                  </li>
               </ul>
            </li>
         </ul>

         <p class="productname"><a href="PivotalHAWQ.html">Pivotal HAWQ</a></p>
         <ul>
            <li>
               <a href="HAWQ1.2.1ReleaseNotes.html">HAWQ 1.2.1 Release Notes</a>
            </li>
            <li>
               <a href="HAWQInstallationandUpgrade.html">HAWQ Installation and Upgrade</a>
               <ul>
                  <li>
                     <a href="PreparingtoInstallHAWQ.html">Preparing to Install HAWQ</a>
                  </li>
                  <li>
                     <a href="InstallingHAWQ.html">Installing HAWQ</a>
                  </li>
                  <li>
                     <a href="InstallingtheHAWQComponents.html">Installing the HAWQ Components</a>
                  </li>
                  <li>
                     <a href="UpgradingHAWQandComponents.html">Upgrading HAWQ and Components</a>
                  </li>
                  <li>
                     <a href="HAWQConfigurationParameterReference.html">HAWQ Configuration Parameter Reference</a>
                  </li>
               </ul>
            </li>
            <li>
               <a href="HAWQAdministration.html">HAWQ Administration</a>
               <ul>
                  <li>
                     <a href="HAWQOverview.html">HAWQ Overview</a>
                  </li>
                  <li>
                     <a href="HAWQQueryProcessing.html">HAWQ Query Processing</a>
                  </li>
                  <li>
                     <a href="UsingHAWQtoQueryData.html">Using HAWQ to Query Data</a>
                  </li>
                  <li>
                     <a href="UsingProceduralLanguages.html">Using Procedural Languages</a>
                  </li>
                  <li>
                     <a href="ConfiguringClientAuthentication.html">Configuring Client Authentication</a>
                  </li>
                  <li>
                     <a href="ConfiguringKerberosAuthentication.html">Configuring Kerberos Authentication</a>
                  </li>
                  <li>
                     <a href="ConfiguringLDAPAuthentication.html">Configuring LDAP Authentication</a>
                  </li>
                  <li>
                     <a href="BackingUpandRestoringHAWQDatabases.html">Backing Up and Restoring HAWQ Databases</a>
                  </li>
                  <li>
                     <a href="ExpandingtheHAWQSystem.html">Expanding the HAWQ System</a>
                  </li>
                  <li>
                     <a href="HAWQInputFormatforMapReduce.html">HAWQ InputFormat for MapReduce</a>
                  </li>
                  <li>
                     <a href="HAWQFilespacesandHighAvailabilityEnabledHDFS.html">HAWQ Filespaces and High Availability Enabled HDFS</a>
                  </li>
                  <li>
                     <a href="SQLCommandReference.html">SQL Command Reference</a>
                     <ul>
                        <li>
                           <a href="ABORT.html">ABORT</a>
                        </li>
                        <li>
                           <a href="ANALYZE.html">ANALYZE</a>
                        </li>
                        <li>
                           <a href="ALTERAGGREGATE.html">ALTER AGGREGATE</a>
                        </li>
                        <li>
                           <a href="ALTERFUNCTION.html">ALTER FUNCTION</a>
                        </li>
                        <li>
                           <a href="ALTEROPERATOR.html">ALTER OPERATOR</a>
                        </li>
                        <li>
                           <a href="ALTEROPERATORCLASS.html">ALTER OPERATOR CLASS</a>
                        </li>
                        <li>
                           <a href="ALTERROLE.html">ALTER ROLE</a>
                        </li>
                        <li>
                           <a href="ALTERTABLE.html">ALTER TABLE</a>
                        </li>
                        <li>
                           <a href="ALTERTABLESPACE.html">ALTER TABLESPACE</a>
                        </li>
                        <li>
                           <a href="ALTERTYPE.html">ALTER TYPE</a>
                        </li>
                        <li>
                           <a href="ALTERUSER.html">ALTER USER</a>
                        </li>
                        <li>
                           <a href="BEGIN.html">BEGIN</a>
                        </li>
                        <li>
                           <a href="CHECKPOINT.html">CHECKPOINT</a>
                        </li>
                        <li>
                           <a href="CLOSE.html">CLOSE</a>
                        </li>
                        <li>
                           <a href="COMMIT.html">COMMIT</a>
                        </li>
                        <li>
                           <a href="COPY.html">COPY</a>
                        </li>
                        <li>
                           <a href="CREATEAGGREGATE.html">CREATE AGGREGATE</a>
                        </li>
                        <li>
                           <a href="CREATEDATABASE.html">CREATE DATABASE</a>
                        </li>
                        <li>
                           <a href="CREATEEXTERNALTABLE.html">CREATE EXTERNAL TABLE</a>
                        </li>
                        <li>
                           <a href="CREATEFUNCTION.html">CREATE FUNCTION</a>
                        </li>
                        <li>
                           <a href="CREATEGROUP.html">CREATE GROUP</a>
                        </li>
                        <li>
                           <a href="CREATELANGUAGE.html">CREATE LANGUAGE</a>
                        </li>
                        <li>
                           <a href="CREATEOPERATOR.html">CREATE OPERATOR</a>
                        </li>
                        <li>
                           <a href="CREATEOPERATORCLASS.html">CREATE OPERATOR CLASS</a>
                        </li>
                        <li>
                           <a href="CREATERESOURCEQUEUE.html">CREATE RESOURCE QUEUE</a>
                        </li>
                        <li>
                           <a href="CREATEROLE.html">CREATE ROLE</a>
                        </li>
                        <li>
                           <a href="CREATESCHEMA.html">CREATE SCHEMA</a>
                        </li>
                        <li>
                           <a href="CREATESEQUENCE.html">CREATE SEQUENCE</a>
                        </li>
                        <li>
                           <a href="CREATETABLE.html">CREATE TABLE</a>
                        </li>
                        <li>
                           <a href="CREATETABLEAS.html">CREATE TABLE AS</a>
                        </li>
                        <li>
                           <a href="CREATETABLESPACE.html">CREATE TABLESPACE</a>
                        </li>
                        <li>
                           <a href="CREATETYPE.html">CREATE TYPE</a>
                        </li>
                        <li>
                           <a href="CREATEUSER.html">CREATE USER</a>
                        </li>
                        <li>
                           <a href="CREATEVIEW.html">CREATE VIEW</a>
                        </li>
                        <li>
                           <a href="DEALLOCATE.html">DEALLOCATE</a>
                        </li>
                        <li>
                           <a href="DECLARE.html">DECLARE</a>
                        </li>
                        <li>
                           <a href="DROPAGGREGATE.html">DROP AGGREGATE</a>
                        </li>
                        <li>
                           <a href="DROPDATABASE.html">DROP DATABASE</a>
                        </li>
                        <li>
                           <a href="DROPEXTERNALTABLE.html">DROP EXTERNAL TABLE</a>
                        </li>
                        <li>
                           <a href="DROPFILESPACE.html">DROP FILESPACE</a>
                        </li>
                        <li>
                           <a href="DROPFUNCTION.html">DROP FUNCTION</a>
                        </li>
                        <li>
                           <a href="DROPGROUP.html">DROP GROUP</a>
                        </li>
                        <li>
                           <a href="DROPOPERATOR.html">DROP OPERATOR</a>
                        </li>
                        <li>
                           <a href="DROPOPERATORCLASS.html">DROP OPERATOR CLASS</a>
                        </li>
                        <li>
                           <a href="DROPOWNED.html">DROP OWNED</a>
                        </li>
                        <li>
                           <a href="DROPRESOURCEQUEUE.html">DROP RESOURCE QUEUE</a>
                        </li>
                        <li>
                           <a href="DROPROLE.html">DROP ROLE</a>
                        </li>
                        <li>
                           <a href="DROPSCHEMA.html">DROP SCHEMA</a>
                        </li>
                        <li>
                           <a href="DROPSEQUENCE.html">DROP SEQUENCE</a>
                        </li>
                        <li>
                           <a href="DROPTABLE.html">DROP TABLE</a>
                        </li>
                        <li>
                           <a href="DROPTABLESPACE.html">DROP TABLESPACE</a>
                        </li>
                        <li>
                           <a href="DROPTYPE.html">DROP TYPE</a>
                        </li>
                        <li>
                           <a href="DROPUSER.html">DROP USER</a>
                        </li>
                        <li>
                           <a href="DROPVIEW.html">DROP VIEW</a>
                        </li>
                        <li>
                           <a href="END.html">END</a>
                        </li>
                        <li>
                           <a href="EXECUTE.html">EXECUTE</a>
                        </li>
                        <li>
                           <a href="EXPLAIN.html">EXPLAIN</a>
                        </li>
                        <li>
                           <a href="FETCH.html">FETCH</a>
                        </li>
                        <li>
                           <a href="GRANT.html">GRANT</a>
                        </li>
                        <li>
                           <a href="INSERT.html">INSERT</a>
                        </li>
                        <li>
                           <a href="PREPARE.html">PREPARE</a>
                        </li>
                        <li>
                           <a href="REASSIGNOWNED.html">REASSIGN OWNED</a>
                        </li>
                        <li>
                           <a href="RELEASESAVEPOINT.html">RELEASE SAVEPOINT</a>
                        </li>
                        <li>
                           <a href="RESET.html">RESET</a>
                        </li>
                        <li>
                           <a href="REVOKE.html">REVOKE</a>
                        </li>
                        <li>
                           <a href="ROLLBACK.html">ROLLBACK</a>
                        </li>
                        <li>
                           <a href="ROLLBACKTOSAVEPOINT.html">ROLLBACK TO SAVEPOINT</a>
                        </li>
                        <li>
                           <a href="SAVEPOINT.html">SAVEPOINT</a>
                        </li>
                        <li>
                           <a href="SELECT.html">SELECT</a>
                        </li>
                        <li>
                           <a href="SELECTINTO.html">SELECT INTO</a>
                        </li>
                        <li>
                           <a href="SET.html">SET</a>
                        </li>
                        <li>
                           <a href="SETROLE.html">SET ROLE</a>
                        </li>
                        <li>
                           <a href="SETSESSIONAUTHORIZATION.html">SET SESSION AUTHORIZATION</a>
                        </li>
                        <li>
                           <a href="SHOW.html">SHOW</a>
                        </li>
                        <li>
                           <a href="TRUNCATE.html">TRUNCATE</a>
                        </li>
                        <li>
                           <a href="VACUUM.html">VACUUM</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="ManagementUtilityReference.html">Management Utility Reference</a>
                     <ul>
                        <li>
                           <a href="gpactivatestandby.html">gpactivatestandby</a>
                        </li>
                        <li>
                           <a href="gpcheckperf.html">gpcheckperf</a>
                        </li>
                        <li>
                           <a href="gpconfig.html">gpconfig</a>
                        </li>
                        <li>
                           <a href="gpexpand.html">gpexpand</a>
                        </li>
                        <li>
                           <a href="gpextract.html">gpextract</a>
                        </li>
                        <li>
                           <a href="gpfdist.html">gpfdist</a>
                        </li>
                        <li>
                           <a href="gpfilespace.html">gpfilespace</a>
                        </li>
                        <li>
                           <a href="gpinitstandby.html">gpinitstandby</a>
                        </li>
                        <li>
                           <a href="gpinitsystem.html">gpinitsystem</a>
                        </li>
                        <li>
                           <a href="gpload.html">gpload</a>
                        </li>
                        <li>
                           <a href="gplogfilter.html">gplogfilter</a>
                        </li>
                        <li>
                           <a href="gprecoverseg.html">gprecoverseg</a>
                        </li>
                        <li>
                           <a href="gpscp.html">gpscp</a>
                        </li>
                        <li>
                           <a href="gpstart.html">gpstart</a>
                        </li>
                        <li>
                           <a href="gpssh.html">gpssh</a>
                        </li>
                        <li>
                           <a href="gssh-exkeys.html">gssh-exkeys</a>
                        </li>
                        <li>
                           <a href="gpstate.html">gpstate</a>
                        </li>
                        <li>
                           <a href="gpstop.html">gpstop</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="ClientUtilityReference.html">Client Utility Reference</a>
                     <ul>
                        <li>
                           <a href="createdb.html">createdb</a>
                        </li>
                        <li>
                           <a href="createlang.html">createlang</a>
                        </li>
                        <li>
                           <a href="createuser.html">createuser</a>
                        </li>
                        <li>
                           <a href="dropdb.html">dropdb</a>
                        </li>
                        <li>
                           <a href="dropuser.html">dropuser</a>
                        </li>
                        <li>
                           <a href="pg_dump.html">pg_dump</a>
                        </li>
                        <li>
                           <a href="pg_dumpall.html">pg_dumpall</a>
                        </li>
                        <li>
                           <a href="pg_restore.html">pg_restore</a>
                        </li>
                        <li>
                           <a href="psql.html">psql</a>
                        </li>
                        <li>
                           <a href="vacuumdb.html">vacuumdb</a>
                        </li>
                     </ul>
                  </li>
                  <li>
                     <a href="HAWQServerConfigurationParameters.html">HAWQ Server Configuration Parameters</a>
                  </li>
                  <li>
                     <a href="CharacterSetSupportReference.html">Character Set Support Reference</a>
                  </li>
                  <li>
                     <a href="HAWQEnvironmentVariables.html">HAWQ Environment Variables</a>
                  </li>
                  <li>
                     <a href="HAWQDataTypes.html">HAWQ Data Types</a>
                  </li>
                  <li>
                     <a href="SystemCatalogReference.html">System Catalog Reference</a>
                  </li>
                  <li>
                     <a href="hawq_toolkitReference.html">hawq_toolkit Reference</a>
                  </li>
                  <li>
                     <a href="ManagingHAWQLogFiles.html">Managing HAWQ Log Files</a>
                  </li>
               </ul>
            </li>
            <li>
               <a href="PivotalExtensionFrameworkPXF.html">Pivotal Extension Framework (PXF)</a>
               <ul>
                  <li>
                     <a href="PXFInstallationandAdministration.html">PXF Installation and Administration</a>
                  </li>
                  <li>
                     <a href="PXFExternalTableandAPIReference.html">PXF External Table and API Reference</a>
                  </li>
               </ul>
            </li>
         </ul>

</div>
   
	<!-- end INSERT SIDENAV -->
	
	<main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
        
          <h1 class="title-container">Upgrade Instructions - 1.1.1 to 2.1.0</h1>
          <div id="js-quick-links"></div>          
        
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>     
        
		<!-- Python script replaces main content -->
		<div style="visibility:hidden; height:2px;">Pivotal Product Documentation : Upgrade Instructions - 1.1.1 to 2.1.0</div><div class="wiki-content group" id="main-content">
<div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>Before you start your upgrade; make sure you have met all the <a href="PHDUpgradePrerequisites.html">Upgrade Prerequisites</a>.</p>
</div>
</div>
<p>Follow the instructions below to upgrade your PHD system.</p><ol><li><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-VerifyState"></span>Verify the current state of the cluster<br/> </strong><ol class="_mce_tagged_br"><li>Using the Pivotal Command Center user interface, check to see if any services are down. If any service is down or is running with errors, address those issues before upgrading.</li><li>On one of the HDFS nodes, as <code>gpadmin</code>, run:<br/> <code>sudo -u hdfs hdfs dfsadmin -report</code> <br/>An example of the output is below.<br/>Make sure that there are no <code>Under replicated blocks</code>, <code>Blocks with corrupt replicas</code>, or <code>Missing blocks</code>. Make sure there are no dead or decommissioned nodes.<code> <br/> </code>If you have decommissioned Data Nodes, removed then from the cluster using the <code>icm_client remove-slaves</code> command (see <a href="ManagingaPHDCluster.html#ManagingaPHDCluster-ShrinkCluster">Shrinking a Cluster</a>). You can always add them back after you have completed the upgrade procedure (see <a href="ManagingaPHDCluster.html#ManagingaPHDCluster-ExpandCluster">Expanding a Cluster</a>).<code> <br/> </code>If you have dead Data Nodes,either remove then or bring them back up.<code> <br/> </code></li><li>Run <code>fsck</code> and ensure that the filesystem is healthy, for example there are no corrupt files. An example of the output is below.<br/><p><strong>dfsadmin report example</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">sudo -u hdfs hdfs dfsadmin -report
Configured Capacity: 93657587712 (87.23 GB)
Present Capacity: 81391808512 (75.80 GB)
DFS Remaining: 81391706112 (75.80 GB)
DFS Used: 102400 (100 KB)
DFS Used%: 0.00%
Under replicated blocks: 0
Blocks with corrupt replicas: 0
Missing blocks: 0
-------------------------------------------------
Datanodes available: 1 (1 total, 0 dead)
Live datanodes:
Name: 192.168.2.203:50010 (rhel64-3.localdomain)
Hostname: rhel64-3.localdomain
Decommission Status : Normal
Configured Capacity: 93657587712 (87.23 GB)
DFS Used: 102400 (100 KB)
Non DFS Used: 12265779200 (11.42 GB)
DFS Remaining: 81391706112 (75.80 GB)
DFS Used%: 0.00%
DFS Remaining%: 86.90%
Last contact: Fri Apr 25 18:39:22 UTC 2014</pre>
</div></div><p><strong>fsck example</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">sudo -u hdfs hdfs fsck /
Connecting to namenode via http://rhel64-3:50070
FSCK started by hdfs (auth:SIMPLE) from /192.168.2.202 for path / at Fri Apr 25 20:56:52 UTC 2014
...Status: HEALTHY
Total size: 366 B
Total dirs: 20
Total files: 3
Total symlinks: 0
Total blocks (validated): 3 (avg. block size 122 B)
Minimally replicated blocks: 3 (100.0 %)
Over-replicated blocks: 0 (0.0 %)
Under-replicated blocks: 0 (0.0 %)
Mis-replicated blocks: 0 (0.0 %)
Default replication factor: 1
Average block replication: 1.0
Corrupt blocks: 0
Missing replicas: 0 (0.0 %)
Number of data-nodes: 1
Number of racks: 1
FSCK ended at Fri Apr 25 20:56:52 UTC 2014 in 211 milliseconds

The filesystem under path '/' is HEALTHY</pre>
</div></div> <div class="aui-message problem shadowed information-macro">
<span class="aui-icon icon-problem">Icon</span>
<div class="message-content">
<p>If you cannot get a cluster into a healthy state, contact Pivotal Support before continuing with your upgrade.</p>
</div>
</div>
</li></ol></li><li><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-BackupHive"></span>Backup the Hive metastore</strong> <br/>Hive does not provide rollback options, so we recommend that you take a snapshot of the metastore DB before starting the upgrade.<br/><ol class="_mce_tagged_br"><li>As <code>gpadmin</code>, login to the machine running the hive metastore database</li><li><p>Use the following command to backup the metastore database.  It will backup the metastore database to file<code> <code>hive_metastore_1.backup</code> </code></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">pg_dump -U hive -p 10432 metastore &gt; hive_metastore_1.backup</pre>
</div></div></li></ol></li><li><strong><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-RevertNonHA"></span>Disable High Availability (if applicable)</strong>: <br/> You cannot upgrade a version 1.1.1 cluster with High Availability enabled. Revert your cluster to non-HA before proceeding with an upgrade. <br/>See <a href="HighAvailability.html#HighAvailability-DisableHA">Disabling HA</a> for details.<strong> </strong> <br/><p>To complete this step for upgrades, run the following SQL command:</p><p><code>psql -U postgres -p 10432 gphdmgr -c "UPDATE cluster_properties SET property_value='false' WHERE cluster_id=&lt;cluster_id&gt; AND property_name='cluster.nn.isHAEnabled';"</code></p><p>Where: &lt;<code>cluster_id&gt;</code> is the id of your cluster.</p>Note that this SQL command is only necessary for upgrades from 1.1.1.<br/> </li><li><strong><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-RevertNonSecure"></span>Revert to Non-Secure (if applicable):</strong> <br/>You cannot upgrade a version 1.1.1 cluster with security enabled. Revert your cluster to non-secure before proceeding with an upgrade. <br/>See <a href="DisablingSecurityona1.1.1Cluster.html">Disabling Security on a 1.1.1 Cluster</a> for details.<strong> </strong><br/><br/></li><li><p><strong><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-ColocateHiveNameNode"></span>For PXF:  Co-locate your hive server and Name Node (if applicable).</strong></p><p>Your upgrade from PHD 1.1.1 to PHD 2.1 with PXF installed will fail if your hive server is not co-located with your Name Node.  To co-locate these, add <code>hive.noarch</code> package on the Name Node and copy <code>hive-site.xml</code> from the hive-server node to the Name Node machine.</p><strong><br/> <br/> </strong></li><li><strong><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-RemoveHAWQStandby"></span>Remove HAWQ Standby Master:<br/> </strong>If you have a HAWQ Standby Master, you need to remove it before you start the upgrade.  As <code>gpadmin</code>, do the following:<br/><ol><li>Source the <code>greenplum_path.sh</code> file:<br/> <code>$ source /usr/local/hawq/greenplum_path.sh</code></li><li><p>Remove the HAWQ Standby Master by running:</p><code>$ gpinitstandby -r</code> <br/>For more details, refer to the <em>HAWQ Installation and Upgrade Guide</em>.</li></ol></li><li><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-StopServices"></span> <strong>Stop Services:</strong><ol><li>As <code>gpadmin</code>, stop HAWQ on the HAWQ master:<br/> <code>$ /etc/init.d/hawq stop </code></li><li>As <code>gpadmin</code>, stop all PHD services:<br/> <code>$ icm_client stop -l &lt;CLUSTER NAME&gt;</code></li><li>As <code>root</code>, stop PCC:<br/> <code>$ service commander stop<br/>  </code></li></ol></li><li><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-ExtractPCC"></span>Import and upgrade PCC:</strong> <br/><ol><li>Download the new PCC file from <a class="external-link" href="https://network.gopivotal.com/" rel="nofollow"> Pivotal Network </a>.</li><li>Copy the new PCC tar file to your installation directory on the admin node, for example: <br/> <code>$ scp ./PCC-2.x.x.<strong> <em>version.build.os</em> </strong>.x86_64.tar.gz host:/root/phd/ </code></li><li>Login as <code>root</code> and untar to that directory:<br/> <code>$ cd /root/phd </code> <br class="atl-forced-newline"/> <code>$ tar --no-same-owner -zxvf PCC-2.x.x.<strong> <em>version.build.os</em> </strong>.x86_64.tar.gz</code></li><li>As <code>root</code>, run the PCC installation script from the directory where it is installed: <br class="atl-forced-newline"/> <code>$ ./install</code></li></ol> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>There is no need to specify that this is an upgrade; the install utility (<code>./install</code>) detects whether it is a fresh install or an upgrade.</p>
</div>
</div>
<div class="aui-message hint shadowed information-macro">
<span class="aui-icon icon-hint">Icon</span>
<div class="message-content">
<p>The rest of the upgrade procedure is performed by the <code>gpadmin</code> user.  Switch to that user now.</p>
</div>
</div>
</li><li><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-SelfUpgrade"></span>CLI Self-Upgrade:</strong> <br/> As <code>gpadmin</code>, run the following command to upgrade the CLI:<br/> <code>$ icm_client self-upgrade</code> <br/>Note that this command may return very quickly. This does not indicate any problems and you can continue with the upgrade.</li><li><p><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-ImportPADS"></span>Import new HAWQ package:</strong></p><ol><li><p>Download and extract the new PADS (HAWQ) package from <a class="external-link" href="https://network.gopivotal.com/" rel="nofollow"> Pivotal Network </a>.</p></li><li><p>Run:</p><p><code>   $ icm_client import -s &lt; PATH TO EXTRACTED PADS TAR BALL  &gt;<br/> </code></p></li></ol></li><li><p><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-UpgradeHAWQ"></span>Upgrade HAWQ:<br/> </strong> <strong> <strong> <br/> </strong> </strong></p> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>This section is only applicable if you installed Pivotal ADS (HAWQ) using PHD's CLI; if you installed Pivotal ADS manually, refer to the <em>HAWQ Installation and Upgrade Guide</em> for manual upgrade instructions.</p>
</div>
</div>
<p> </p><ol><li><p>To upgrade PADS (HAWQ), as <code>gpadmin</code>, run:<br/> <code> $ icm_client upgrade -l &lt;CLUSTERNAME&gt; -s pads -o &lt; PATH TO EXTRACTED OLD ADS TAR BALL &gt; -n &lt; PATH TO EXTRACTED NEW ADS TAR BALL &gt;<br/> </code></p></li><li><p>Optional: You can delete the old HAWQ rpm file by running:<br/> <code>$ yum erase &lt;HAWQ_OLD_RPM_NAME&gt; <br/> </code></p></li></ol></li><li><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-ImportPRTS"></span> <strong>Import new PRTS (for GemFire XD) package:</strong><br/><ol><li><p>Download and extract the new PRTS  package from <a class="external-link" href="https://network.gopivotal.com/" rel="nofollow">Pivotal Network</a>.</p></li><li><p>Run:</p><p><code>   $ icm_client import -s &lt; PATH TO EXTRACTED PRTS TAR BALL  &gt;</code></p></li></ol><strong><br/></strong></li><li><div><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-UpgradePRTS"></span><strong>Upgrade PRTS (for GemFire XD):</strong></div><div>As <code>gpadmin</code>, run:</div><div><p><code>$ icm_client upgrade -l &lt;CLUSTERNAME&gt; -s prts</code></p></div><br/><strong> </strong></li><li><strong><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-ImportPHD"></span>Import new PHD package:</strong><ol><li>Download and extract the new PHD package from <a class="external-link" href="https://network.gopivotal.com/" rel="nofollow"> Pivotal Network </a>.</li><li>Run:<br/> <code>$ icm_client import -s &lt; PATH TO EXTRACTED PHD TAR BALL  &gt; <br/> </code></li></ol></li><li><strong> <strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-UpgradePHD"></span></strong>Upgrade PHD:<strong><br/> </strong> </strong>If your cluster is configured with HAWQ, make sure you complete upgrading Pivotal ADS (Upgrade HAWQ step, above), before proceeding with Pivotal HD upgrade.<br/><br/>PHD 2.x requires Oracle JDK 1.7.  If you are already running JDK 1.7, proceed with the PHD Upgrade, step b, below.  If you need to upgrade to JDK 1.7, first complete step a, below.<br/><ol><li><p>Import JDK: </p><p>JDK 1.7 running on the Admin node is a prerequisite.  This step is to import a downloaded JDK package that will be deployed across the cluster.</p><ol><li>Download a supported JDK package from <a class="external-link" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" rel="nofollow">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a>.<br/>PHD expects an rpm package, for example: jdk-7u45-linux-x64.rpm</li><li><p>Import the downloaded JDK package to the cluster nodes:<br/>As <code>gpadmin</code>, run:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ icm_client import -r &lt;PATH TO JDK&gt;</pre>
</div></div> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>If you have manually installed UnlimitedJCEPolicy files prior to upgrading your JDK, you will need to re-install them post upgrade.</p>
</div>
</div>
</li></ol></li><li><p>Upgrade PHD, as <code>gpadmin</code>, run:</p><code>$ icm_client upgrade -l &lt;CLUSTERNAME&gt; -s phd</code><p>If you need to upgrade to JDK 1.7, include the imported JDK rpm in the upgrade command (for example: <code>jdk-7u45-linux-x64.rpm</code>) so that the <code>upgrade </code>command can deploy it to the cluster nodes:</p><p><code> <code>$ icm_client upgrade -l &lt;CLUSTERNAME&gt; -s phd</code> -j ~/jdk-7u45-linux-x64.rpm </code></p><br/>This upgrades the PHD stack on all cluster nodes.<br/><p>Note that all upgrade steps, including post-upgrade configuration steps described below, should be completed before you re-enable HA or security on a cluster.</p></li></ol></li><li><p><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-UpgradePXF"></span>If you have PXF using GemFire XD as a data source:</p><p>Add <code>'/usr/lib/gphd/gfxd/lib/gemfirexd.jar'</code> on a new line to <code>ClusterConfigDir/pxf/pxf-public.classpath</code>.</p></li><li><strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-PostUpgrade"></span></strong></strong></strong></strong></strong></strong></strong>Upgrade Configuration Files:<br/> </strong>After upgrading the PHD stack, you need to upgrade your cluster configuration files:<strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <strong> <br/> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong> </strong><ol><li><p>Fetch the new templates that come with the upgraded stack by running <code>icm_client fetch-template</code>, for example: </p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">icm_client fetch-template -o ~/newTemplate</pre>
</div></div><p><code>newTemplate</code> is the new template for the upgraded stack without any user customizations.</p></li><li><p>Retrieve the existing configuration from the database by running<code> </code> <code>icm_client fetch-configuration</code>, for example:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">icm_client fetch-configuration -o ~/origConfiguration -l &lt;CLUSTERNAME&gt;</pre>
</div></div><p><code>origConfiguration</code> is based on user-customized template from a previous installation.</p><p> </p></li><li><p> Identify the changes between the configurations by running the <code>diff</code> command, for example:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">diff -ruBw newTemplate/ origConfiguration/</pre>
</div></div><p>Then apply those changes to the <code>newTemplate</code> you retrieved.<code>  </code></p><p> </p> <div class="aui-message hint shadowed information-macro">
<p class="title">TIP</p>
<span class="aui-icon icon-hint">Icon</span>
<div class="message-content">
<div>To simplify the process of merging the existing PHD configuration with the <code>newTemplate</code> (step 3c, above) follow these steps:<br/> 1. Overwrite<code> clusterConfig.xml</code> in <code>newTemplate</code> with the one from the<code> origConfiguration</code> directory:<code> <br/>   cp ~/origConfiguration/clusterConfig.xml  ~/newTemplate/clusterConfig.xml</code> <br/> 2. Change the value of <code>&lt;gphdStackVer&gt;</code> to PHD-2.1.0.0 in the <code>~/newTemplate/clusterConfig.xml</code> <br/> 3. If you have explicitly modified any properties from PHD services configuration files such as, <code>hdfs/hdfs-site.xml</code>, <code>yarn/yarn-site.xml</code> etc., then make the corresponding changes to these configuration files under  <code>~newTemplate/</code> directory.</div>
</div>
</div>
<p><code> <br/> </code></p></li><li>This step is only required if <code>gpxf</code> was a configured service in the existing cluster configuration.<br/>Make the following changes to <code>clusterConfig.xml</code> your <code>newTemplate </code>directory:<br/><br/>Remove <code>gpxf</code> from the<code> &lt;services&gt;</code> list.<br/><br/>Add <code>pxf</code> to the<code> &lt;services&gt;</code> list.<br/><span>   * Add <code>pxf-service</code> role to <code>&lt;hostRoleMapping&gt;</code>. Colocate the <code>pxf-service</code> role with namenode and datanode.</span><br/><span>   </span><code><span>  &lt;pxf&gt;</span></code><p><code><span>     &lt;pxf-service&gt;&lt;/pxf-service&gt;</span></code></p><p><code><span>    &lt;/pxf&gt;</span></code><br/><br/>Delete the <code>gpxf</code> directory from <code><code>newTemplate</code></code> directory:</p><code>   $ rm -rf <code>newTemplate</code>/gpxf</code><br/><br/>Add the new PXF template to <code>newTemplate</code>. You can do this by fetching the new template and copying the<code> pxf</code> directory from the template.<br/>       For example, <span style="color: rgb(0,0,0);">as <code>gpadmin</code>, run:</span>: <br/><code>   $ mkdir new_template</code><br/><code>   $ icm_client fetch-template -o new_template</code><br/><code>   $ cp -r <span>new_template/pxf </span><code><code>newTemplate</code></code></code><br/><br/></li><li>Change the <code>&lt;gphdVersion&gt;</code> field to <code>PHD- 2.1.0.0</code>. <br/><br/></li><li><p>Upgrade services by specifying the cluster configuration directory as <code>~/newTemplate</code> with your updated contents:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: bash; gutter: false" style="font-size:12px;">icm_client reconfigure -c ~/newTemplate -l &lt;CLUSTERNAME&gt; -f</pre>
</div></div></li></ol></li><li><p><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-UpgradeHDFS"></span>Upgrade HDFS:<br/> </strong></p> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>If you are performing the upgrade on an EMC Data Computing Appliance (DCA), you need to make sure that the <code>gpadmin</code> user has read access to each of the subdirectories of the NameNode name directories. The location of the NameNode name directories is specified in the value of the <code>dfs.namenode.name.dir</code> property in <code>/etc/gphd/hadoop/conf/hdfs-</code><code>site.xml</code> on the NameNode.</p><p>For example, if <code>/data/nn/dfs/name</code> is the NameNode directory, then the <code>gpadmin</code> user must have read access to <code>data</code>, <code>nn</code> , <code>dfs</code> and <code>name</code> directories.</p>
</div>
</div>
<p><br/>As <code>gpadmin</code>, on the Admin node, do the following:</p><ol><li><p>Backup the NameNode metadata by running:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">/usr/bin/python /usr/lib/gphd/gphdmgr/lib/client/HdfsUpgrader.py -l &lt;CLUSTER NAME&gt; -o backupNNMetadata -s 2.0.5_alpha_gphd_2_1_1_0 -t 2.2.0_gphd_3_1_0_0</pre>
</div></div></li><li><p>Run the NameNode upgrade by running:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">/usr/bin/python /usr/lib/gphd/gphdmgr/lib/client/HdfsUpgrader.py -l &lt;CLUSTER NAME&gt; -o nnupgrade -s 2.0.5_alpha_gphd_2_1_1_0 -t 2.2.0_gphd_3_1_0_0
</pre>
</div></div></li><li><p>Run the DataNode upgrade by running:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">/usr/bin/python /usr/lib/gphd/gphdmgr/lib/client/HdfsUpgrader.py -l &lt;CLUSTER NAME&gt; -o dnupgrade -s 2.0.5_alpha_gphd_2_1_1_0 -t 2.2.0_gphd_3_1_0_0
</pre>
</div></div></li></ol></li><li><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-StopRestart"></span> <strong>Restart the cluster:<br/> </strong><p>As <code>gpadmin</code>, run:<br/> <code>$ icm_client restart -l &lt;CLUSTERNAME&gt;</code></p><strong> <br/> <br/> </strong></li><li><span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-PostUpgradeHAWQ"></span> <strong>Post-Upgrade HAWQ:</strong><br/>Before you perform this step, if you have Madlib dependencies, refer to the <em>HAWQ Installation and Upgrade Guide</em> for instructions for upgrading Madlib.<strong><br/> </strong><ol><li><p>On the HAWQ master node, as  <code>gpadmin</code>, run the following commands to migrate data: </p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: bash; gutter: false" style="font-size:12px;">su - gpadmin
source /usr/lib/gphd/hawq/greenplum_path.sh
gpmigrator &lt;old_HAWQHOME_path&gt; &lt;new_HAWQHOME_path&gt; # Look into ls -laF /usr/local and find the old and new homes.

# For example:
gpmigrator /usr/local/hawq-1.1.4.0/ /usr/local/hawq-1.2.1.0/ -d /data1/master/gpseg-1</pre>
</div></div> <div class="aui-message warning shadowed information-macro">
<p class="title">Notes</p>
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>The<code> gpmigrator</code> command also starts HAWQ</p><p>If you encounter errors migrating HAWQ data, refer to the <em>HAWQ Administrator Guide</em> for help.</p>
</div>
</div>
</li><li><p>If you were utilizing a standby HAWQ master, you should have removed it before the upgrade. It should now be reinitialized: <br/>On the HAWQ master, as <code>gpadmin</code>, run:</p><p><code>$ gpinitstandby -s &lt;standby_hostname&gt;<br/> </code> <br/> For more details about these commands, refer to the <em>HAWQ Installation and Upgrade Guide</em>.</p></li></ol></li><li><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-FinalizeHDFS"></span>Finalize the HDFS upgrade:<br/> </strong>Before you continue, you should run a few tests to make sure your data upgrade was successful, and then you can run <code>finalizeUpgrade</code>.<p>Once you have confirmed your cluster is working as expected, run the following command to finalize the upgrade process:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">/usr/bin/python /usr/lib/gphd/gphdmgr/lib/client/HdfsUpgrader.py -l &lt;CLUSTER NAME&gt; -o finalizeUpgrade -s 2.0.5_alpha_gphd_2_1_1_0 -t 2.2.0_gphd_3_1_0_0</pre>
</div></div> <div class="aui-message problem shadowed information-macro">
<span class="aui-icon icon-problem">Icon</span>
<div class="message-content">
<p>HBase master will not start unless the HBase upgrade is finalized. Please ensure HDFS upgrade is finalized before finalizing HBase upgrade.</p>
</div>
</div>
</li><li><strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-FinalizeHBase"></span>Finalize HBase Upgrade:</strong> <br/> <br/><ol><li><p>Check for any HFileV1 data (only HFileV2 is supported after upgrade to HBase 0.96):<br/>On the hbase-master run:<br/> <code>$ sudo -u hbase hbase upgrade -check</code> <br/>If the return is:<br/> <code>Count of HFileV1:0</code> <br/>Continue with the upgrade.</p> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>As part of the prerequisites, you should have already compacted all the tables on the existing HBase cluster; this will have overwritten any HFileV1 data to HFileV2 format.</p>
</div>
</div>
</li><li>Make sure Zookeeper and HDFS are running but HBase is stopped, then run: </li></ol><p style="margin-left: 30.0px;"><code>      $ sudo -u hbase hbase upgrade -execute<br/> <br/> </code></p></li><li><p><strong> <strong> <strong> <strong> <span class="confluence-anchor-link" id="UpgradeInstructions-1.1.1to2.1.0-Manual"></span></strong></strong></strong>Reconfigure Manually Installed Services:<br/> </strong>Services that were manually installed on an existing cluster are not upgraded by a CLI upgrade. After the PHD upgrade, you need to manually reconfigure these services to work with the upgraded PHD.  Refer to the <em>Pivotal HD Enterprise Stack and Tool Reference Guide</em> for details.</p> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>Backing up the configuration files for these services is a prerequisite for this upgrade procedure.  See the <em> <a href="StackandToolsReference.html">Pivotal HD Enterprise Stack and Tools Reference</a> </em>for the locations of these configuration files.</p>
</div>
</div>
<p><br/><br/></p></li><li><strong>Re-enable High availability:</strong><br/>See <a href="HighAvailability.html">High Availability</a> for details.<br/>Note that for fresh installations of PHD 2.1, high availability is enabled by default.  For upgrades however, you will have to re-enable high availability.<br/><br/></li><li><strong>Re-Secure the Cluster:</strong> <br/>See <span class="with-breadcrumbs"><a href="SecurityKerberosAuthentication.html">Security/Kerberos Authentication</a></span> for details.<br/><br/>If you are not using HAWQ in a HA environment, your cluster should now be upgraded.  <br/><br/></li><li><strong>For HA Clusters: Move HAWQ filespace to HA enabled HDFS:<br/> </strong>For HAWQ, you need to move the HAWQ filespace to HA-enabled HDFS, as described in the next step, <a href="MovingHAWQFilespacetoHA-enabledHDFS-1.1.1to2.1.0.html">Moving HAWQ Filespace to HA-enabled HDFS (1.1.1 x to 2.1.0)</a>. Your cluster should now be upgraded.<br/><br/></li><li><strong>For GemFire XD:</strong> Once you have upgraded PHD you need to to reconfigure the cluster to add the GFXD service.  See <span class="with-breadcrumbs"><a href="AddingRemovingServices.html">Adding/Removing Services</a></span> for details.</li></ol><p>At this point, you should check to see if all your services are running and your data is intact. <a href="RunningPHDSamplePrograms.html">Running PHD Sample Programs</a> provides instructions for testing the various services.</p>
</div>
		
		</main><!--end of content-->

  </div><!-- end of container -->

  <script type="text/javascript">
    (function() {
      var didInit = false;
      function initMunchkin() {
        if(didInit === false) {
          didInit = true;
          Munchkin.init('625-IUJ-009');
        }
      }
      var s = document.createElement('script');
      s.type = 'text/javascript';
      s.async = true;
      s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
      s.onreadystatechange = function() {
        if (this.readyState == 'complete' || this.readyState == 'loaded') {
          initMunchkin();
        }
      };
      s.onload = initMunchkin;
      document.getElementsByTagName('head')[0].appendChild(s);
    })();
  </script>
</div><!--end of wrap-->
</div><!--end of viewport-->

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
      <a href='/'>Pivotal Documentation</a>
      &copy; 2014 <a href='http://pivotal.io'>Pivotal Software</a> Inc. All Rights Reserved.
  </div>
  <div class="support">
    Need help? <a href="http://support.pivotal.io" target="_blank">Visit support</a>
  </footer>
</div><!--end of container-->

</body>
</html>


            
      
      
      
      