
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head><meta xmlns="http://www.w3.org/1999/xhtml" name="description" content="Adds and/or initializes a standby master host for a HAWQ system. Synopsis gpinitstandby { -s standby_hostname | -r | -n } [ -M smart | -M fast] [ -a ] [ -q ] [ -D ] [ -L ] [ -l logfile_directory ] ..."/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="copyright" content="(C) Copyright 2005"/><meta name="DC.rights.owner" content="(C) Copyright 2005"/><meta name="DC.Type" content="topic"/><meta name="DC.Title" content="gpinitstandby"/><meta name="DC.Relation" scheme="URI" content="../hawq-topics/ManagementUtilityReference.html"/><meta name="prodname" content=""/><meta name="version" content="2.1.0"/><meta name="release" content=""/><meta name="modification" content=""/><meta name="DC.Format" content="XHTML"/><meta name="DC.Identifier" content="topic1"/><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>gpinitstandby</title><meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Type" content="text/html; charset=utf-8"><!----></meta><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/pivotal.css"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript"><!--
          
          var prefix = "../index.html";
          
          --></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" id="topic1"><script xmlns="http://www.w3.org/1999/xhtml" src="//use.typekit.net/clb0qji.js" type="text/javascript"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  try {
				  Typekit.load();
			  } catch (e) {
			  }
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  document.domain = "pivotal.io";
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			WebFontConfig = {
			  google: { families: [ 'Source+Sans+Pro:300italic,400italic,300,400,600:latin' ] }
			};
			(function() {
			  var wf = document.createElement('script');
			  wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
				'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
			  wf.type = 'text/javascript';
			  wf.async = 'true';
			  var s = document.getElementsByTagName('script')[0];
			  s.parentNode.insertBefore(wf, s);
			})();
		  </script>
<table class="nav"><tbody><tr><td colspan="2"><div id="permalink"><a href="#">linkToThis</a></div><div id="printlink"><a href="javascript:window.print();">printThisPage</a></div></td></tr><tr><td><div class="navheader">
<span class="navparent"><a class="link" href="../hawq-topics/ManagementUtilityReference.html" title="Management Utility Reference"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Management Utility Reference</span></a></span>  </div></td><td width="75%"><a class="navheader_parent_path" href="../hawq-topics/../hawq-topics/HAWQAdministration.html" title="HAWQ Administration">HAWQ Administration</a> / <a class="navheader_parent_path" href="../hawq-topics/ManagementUtilityReference.html" title="Management Utility Reference">Management Utility Reference</a></td></tr></tbody></table>
<h1 class="title topictitle1">gpinitstandby</h1>
<div class="body"><p class="p">Adds and/or initializes a standby master host for a HAWQ system.</p>
<div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2><pre class="pre codeblock"><strong class="ph b">gpinitstandby</strong> 
      { <strong class="ph b">-s</strong> <var class="keyword varname">standby_hostname</var> | <strong class="ph b">-r</strong> | <strong class="ph b">-n</strong> } 
      [<strong class="ph b">-M</strong> smart | <strong class="ph b">-M</strong> fast] [<strong class="ph b">-a</strong>] [<strong class="ph b">-q</strong>] [<strong class="ph b">-D</strong>] [<strong class="ph b">-L</strong>]
      [<strong class="ph b">-l</strong> <var class="keyword varname">logfile_directory</var>]

<strong class="ph b">gpinitstandby</strong> <strong class="ph b">-?</strong> | <strong class="ph b">-v</strong> </pre>
</div>
<div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2><p class="p">The <samp class="ph codeph">gpinitstandby</samp> utility adds a backup, standby master host to your HAWQ
        system. If your system has an existing standby master host configured, use the
          <samp class="ph codeph">-r</samp> option to remove it before adding the new standby master host. </p>
<p class="p">Before running this utility, make sure that the HAWQ software is installed on the standby master
        host and that you have exchanged SSH keys between the hosts. It is recommended that the
        master port is set to the same port number on the master host and the backup master host. </p>
<p class="p">This utility should be run on the currently active <em class="ph i">primary</em> master host. See the <a class="xref" href="HAWQInstallationandUpgrade.html#hawqinstallationandupgrade">HAWQ Installation and
          Upgrade</a> for instructions.</p>
<p class="p">The utility performs the following steps:</p>
<ul class="ul"><li class="li" id="topic1__js138559">Shut down your HAWQ system.</li>

        <li class="li">Update the HAWQ system catalog to remove the existing backup master host information (if
          the -r option is supplied). </li>

        <li class="li">Update the HAWQ system catalog to add the new backup master host information (use the -n
          option to skip this step). </li>

        <li class="li">Edit the pg_hba.conf files of the segment instances to allow access from the newly added
          standby master. </li>

        <li class="li">Set up the backup master instance on the alternate master host. </li>

        <li class="li">Start the synchronization process. </li>

        <li class="li">Restart your HAWQ system.</li>
</ul>
<p class="p">A backup master host serves as a ‘warm standby’ in the event of the primary master host becoming
        inoperable. The backup master is kept up-to-date by a transaction log replication process
          (<samp class="ph codeph">gpsyncagent</samp>), which runs on the backup master host and keeps the data
        between the primary and backup master hosts synchronized. If the primary master fails, the
        log replication process is shut down, and the backup master can be activated in its place by
        using the utility. Upon activation of the backup master, the replicated logs are used to
        reconstruct the state of the master host at the time of the last successfully committed
        transaction. </p>
<p class="p">The activated standby master effectively becomes the HAWQ master, accepting client connections on
        the master port and performing normal master operations such as SQL command processing and
        workload management. </p>
</div>
<div class="section" id="topic1__section4"><h2 class="title sectiontitle">Options</h2><dl class="dl parml"><dt class="dt pt dlterm">-a (do not prompt)</dt>
<dd class="dd pd">Do not prompt the user for confirmation.</dd>
<dt class="dt pt dlterm">-D (debug)</dt>
<dd class="dd pd">Sets logging level to debug.</dd>

        
          <dt class="dt pt dlterm">-l <var class="keyword varname">logfile_directory</var></dt>

          <dd class="dd pd">The directory to write the log file. Defaults to <samp class="ph codeph">~/gpAdminLogs</samp>.</dd>

        
        
          <dt class="dt pt dlterm">-L (leave database stopped)</dt>

          <dd class="dd pd">Leave HAWQ in a stopped state after removing the warm standby master.</dd>

        
        
          <dt class="dt pt dlterm">-M fast (fast shutdown - rollback)</dt>

          <dd class="dd pd">Use fast shut down when stopping HAWQ at the beginning of the standby initialization
            process. Any transactions in progress are interrupted and rolled back.</dd>

        
        
          <dt class="dt pt dlterm">-M smart (smart shutdown - warn)</dt>

          <dd class="dd pd">Use smart shut down when stopping HAWQ at the beginning of the standby initialization
            process. If there are active connections, this command fails with a warning. This is the
            default shutdown mode.</dd>

        <dt class="dt pt dlterm">-n (resynchronize)</dt>
<dd class="dd pd">Use this option if you already have a standby master configured, and just want to resynchronize
            the data between the primary and backup master host. The HAWQ system catalog tables will
            not be updated.</dd>
<dt class="dt pt dlterm">-q (no screen output)</dt>
<dd class="dd pd">Run in quiet mode. Command output is not displayed on the screen,
but is still written to the log file.</dd>
<dt class="dt pt dlterm">-r (remove standby master)</dt>
<dd class="dd pd">Removes the currently configured standby master host from your HAWQ system.</dd>
<dt class="dt pt dlterm">-s standby_hostname</dt>
<dd class="dd pd">The host name of the standby master host.</dd>
<dt class="dt pt dlterm">-v (show utility version)</dt>
<dd class="dd pd">Displays the version, status, last updated date, and check sum of
this utility.</dd>
<dt class="dt pt dlterm">-? (help)</dt>
<dd class="dd pd">Displays the online help.</dd>
</dl>
</div>
<div class="section" id="topic1__section5"><h2 class="title sectiontitle">Examples</h2><p class="p">Add a backup master host to your HAWQ system and start the synchronization process:</p>
<pre class="pre codeblock">gpinitstandby -s host09</pre>

      <p class="p">Remove the existing standby master from your HAWQ system configuration:</p>

      <pre class="pre codeblock">gpinitstandby -r</pre>
<p class="p">Start an existing backup master host and synchronize the data with the current primary master
        host. Do not add a new HAWQ backup master host to the system catalog.</p>
<pre class="pre codeblock">gpinitstandby -n</pre>
<div class="note note"><span class="notetitle">Note:</span> Do not specify the -n and -s options in the same command.</div>
</div>
</div>
<div class="related-links"/>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../hawq-topics/ManagementUtilityReference.html" title="Management Utility Reference"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Management Utility Reference</span></a></span>  </div><div>
<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
      <a href="http://docs.pivotal.io" target="_blank">Pivotal Documentation</a>
      © 2014 <a href="http://www.pivotal.io/" target="_blank">Pivotal Software</a>, Inc. All Rights Reserved.
  </div>
  <div class="support">
    Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
   </div>
  </footer>
</div><!--end of container-->
</div>
</body>
</html>