
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head><meta xmlns="http://www.w3.org/1999/xhtml" name="description" content="Stops or restarts a HAWQ system. Synopsis gpstop [ -d master_data_directory ] [ -B parallel_processes ] [ -M smart | fast | immediate] [ -t timeout_seconds ] [ -r ] [ -y ] [ -a ] [ -l   ..."/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="copyright" content="(C) Copyright 2005"/><meta name="DC.rights.owner" content="(C) Copyright 2005"/><meta name="DC.Type" content="topic"/><meta name="DC.Title" content="gpstop"/><meta name="DC.Relation" scheme="URI" content="../topics/ManagementUtilityReference.html"/><meta name="prodname" content=""/><meta name="version" content="2.1.0"/><meta name="release" content=""/><meta name="modification" content=""/><meta name="DC.Format" content="XHTML"/><meta name="DC.Identifier" content="topic1"/><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>gpstop</title><meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Type" content="text/html; charset=utf-8"><!----></meta><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/pivotal.css"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript"><!--
          
          var prefix = "../index.html";
          
          --></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" id="topic1"><script xmlns="http://www.w3.org/1999/xhtml" src="//use.typekit.net/clb0qji.js" type="text/javascript"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  try {
				  Typekit.load();
			  } catch (e) {
			  }
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  document.domain = "pivotal.io";
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			WebFontConfig = {
			  google: { families: [ 'Source+Sans+Pro:300italic,400italic,300,400,600:latin' ] }
			};
			(function() {
			  var wf = document.createElement('script');
			  wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
				'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
			  wf.type = 'text/javascript';
			  wf.async = 'true';
			  var s = document.getElementsByTagName('script')[0];
			  s.parentNode.insertBefore(wf, s);
			})();
		  </script>
<table class="nav"><tbody><tr><td colspan="2"><div id="permalink"><a href="#" title="Link to this page"/></div><div id="printlink"><a href="javascript:window.print();" title="Print this page"/></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="../topics/../topics/HAWQAdministration.html" title="HAWQ Administration">HAWQ Administration</a> / <a class="navheader_parent_path" href="../topics/ManagementUtilityReference.html" title="Management Utility Reference">Management Utility Reference</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="../topics/ManagementUtilityReference.html" title="Management Utility Reference"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Management Utility Reference</span></a></span>  </div></td></tr></tbody></table>
<h1 class="title topictitle1">gpstop</h1>
<div class="body"><p class="p">Stops or restarts a HAWQ system.</p>
<div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2><pre class="pre codeblock"><strong class="ph b">gpstop</strong> [<strong class="ph b">-d</strong> <var class="keyword varname">master_data_directory</var>] [<strong class="ph b">-B</strong> <var class="keyword varname">parallel_processes</var>] 
       [<strong class="ph b">-M</strong> smart | fast | immediate] [<strong class="ph b">-t</strong> <var class="keyword varname">timeout_seconds</var>] [<strong class="ph b">-r</strong>] [<strong class="ph b">-y</strong>] [<strong class="ph b">-a</strong>] 
       [<strong class="ph b">-l</strong> <var class="keyword varname">logfile_directory</var>] [<strong class="ph b">-v</strong> | <strong class="ph b">-q</strong>]

<strong class="ph b">gpstop</strong> <strong class="ph b">-m</strong> [<strong class="ph b">-d</strong> <var class="keyword varname">master_data_directory</var>] [<strong class="ph b">-y</strong>] [<strong class="ph b">-l</strong> <var class="keyword varname">logfile_directory</var>] [<strong class="ph b">-v</strong> | <strong class="ph b">-q</strong>]

<strong class="ph b">gpstop</strong> <strong class="ph b">-u</strong> [<strong class="ph b">-d</strong> <var class="keyword varname">master_data_directory</var>] [<strong class="ph b">-l</strong> <var class="keyword varname">logfile_directory</var>] [<strong class="ph b">-v</strong> | <strong class="ph b">-q</strong>]
 
<strong class="ph b">gpstop</strong> <strong class="ph b">--version</strong> 

<strong class="ph b">gpstop</strong> <strong class="ph b">-?</strong> | <strong class="ph b">-h</strong> | <strong class="ph b">--help</strong></pre>
</div>
<div class="section" id="topic1__section3"><h2 class="title sectiontitle">Description</h2><p class="p">The <samp class="ph codeph">gpstop</samp> utility is used to stop the database servers that comprise a HAWQ
        system. When you stop a HAWQ system, you are actually stopping several
          <samp class="ph codeph">postgres</samp> database server processes at once (the master and all of the
        segment instances). The <samp class="ph codeph">gpstop</samp> utility handles the shutdown of the
        individual instances. Each instance is shutdown in parallel. </p>
<p class="p">By default, you are not allowed to shut down HAWQ if there are any client connections to the
        database. Use the <samp class="ph codeph">-M fast</samp> option to roll back all in progress transactions
        and terminate any connections before shutting down. If there are any transactions in
        progress, the default behavior is to wait for them to commit before shutting down.</p>
<p class="p">With the <samp class="ph codeph">-u</samp> option, the utility uploads changes made to the master
          <samp class="ph codeph">pg_hba.conf</samp> file or to <em class="ph i">runtime</em> configuration parameters in the
        master <samp class="ph codeph">postgresql.conf</samp> file without interruption of service. Note that any
        active sessions will not pickup the changes until they reconnect to the database.</p>
</div>
<div class="section" id="topic1__section4"><h2 class="title sectiontitle">Options</h2><dl class="dl parml"><dt class="dt pt dlterm">-a (do not prompt)</dt>
<dd class="dd pd">Do not prompt the user for confirmation.</dd>
<dt class="dt pt dlterm">-B <var class="keyword varname">parallel_processes</var></dt>
<dd class="dd pd">The number of segments to stop in parallel. If not specified, the utility will start up to 60
            parallel processes depending on how many segment instances it needs to stop.</dd>
<dt class="dt pt dlterm">-d <var class="keyword varname">master_data_directory</var></dt>
<dd class="dd pd">Optional. The master host data directory. If not specified, the value
set for <samp class="ph codeph">$MASTER_DATA_DIRECTORY</samp> will be used.</dd>
<dt class="dt pt dlterm">-l <var class="keyword varname">logfile_directory</var></dt>
<dd class="dd pd">The directory to write the log file. Defaults to <samp class="ph codeph">~/gpAdminLogs</samp>.</dd>
<dt class="dt pt dlterm">-m (master only)</dt>
<dd class="dd pd">Optional. Shuts down a HAWQ master instance that was started in maintenance mode.</dd>
<dt class="dt pt dlterm">-M fast (fast shutdown - rollback)</dt>
<dd class="dd pd">Fast shut down. Any transactions in progress are interrupted and
rolled back.</dd>
<dt class="dt pt dlterm">-M immediate (immediate shutdown - abort)</dt>
<dd class="dd pd">Immediate shut down. Any transactions in progress are aborted. This shutdown mode is not
            recommended. This mode kills all database processes without allowing the database server
            to complete transaction processing or clean up any temporary or in-process work
            files.</dd>
<dt class="dt pt dlterm">-M smart (smart shutdown - warn)</dt>
<dd class="dd pd">Smart shut down. If there are active connections, this command fails
with a warning. This is the default shutdown mode.</dd>
<dt class="dt pt dlterm">-q (no screen output)</dt>
<dd class="dd pd">Run in quiet mode. Command output is not displayed on the screen,
but is still written to the log file.</dd>
<dt class="dt pt dlterm">-r (restart)</dt>
<dd class="dd pd">Restart after shutdown is complete.</dd>
<dt class="dt pt dlterm">-t <var class="keyword varname">timeout_seconds</var></dt>
<dd class="dd pd">Specifies a timeout threshold (in seconds) to wait for a segment instance to shutdown. If a
            segment instance does not shutdown in the specified number of seconds,
              <samp class="ph codeph">gpstop</samp> displays a message indicating that one or more segments are
            still in the process of shutting down and that you cannot restart HAWQ until the segment
            instance(s) are stopped. This option is useful in situations where
              <samp class="ph codeph">gpstop</samp> is executed and there are very large transactions that need to
            rollback. These large transactions can take over a minute to rollback and surpass the
            default timeout period of 600 seconds.</dd>
<dt class="dt pt dlterm">-u (reload <samp class="ph codeph">pg_hba.conf</samp> and <samp class="ph codeph">postgresql.conf</samp> files only)</dt>
<dd class="dd pd">This option reloads the <samp class="ph codeph">pg_hba.conf</samp> files of the master and segments and the
            runtime parameters of the <samp class="ph codeph">postgresql.conf</samp> files but does not shutdown
            the HAWQ array. Use this option to make new configuration settings active after editing
              <span class="ph filepath">postgresql.conf </span>or <span class="ph filepath">pg_hba.conf</span>. Note that
            this only applies to configuration parameters that are designated as <em class="ph i">runtime</em>
            parameters. In HAWQ if there are some failed segments, this option can not be
            executed.</dd>
<dt class="dt pt dlterm">-v (verbose output)</dt>
<dd class="dd pd">Displays detailed status, progress and error messages output by the
utility.</dd>

        
          <dt class="dt pt dlterm">--version (show utility version)</dt>

          <dd class="dd pd">Displays the version of this utility.</dd>

        <dt class="dt pt dlterm">-y (do not stop standby master)</dt>
<dd class="dd pd">Do not stop the standby master process. The default is to stop the
standby master.</dd>
<dt class="dt pt dlterm">-? | -h | --help (help)</dt>
<dd class="dd pd">Displays the online help.</dd>
</dl>
</div>
<div class="section" id="topic1__section5"><h2 class="title sectiontitle">Examples</h2><p class="p">Stop a HAWQ system in smart mode:</p>
<pre class="pre codeblock">gpstop</pre>
<p class="p">Stop a HAWQ system in fast mode:</p>
<pre class="pre codeblock">gpstop -M fast</pre>
<p class="p">Stop all segment instances and then restart the system:</p>
<pre class="pre codeblock">gpstop -r</pre>
<p class="p">Stop a master instance that was started in maintenance mode:</p>
<pre class="pre codeblock">gpstop -m</pre>
<p class="p">Reload the <samp class="ph codeph">postgresql.conf</samp> and <samp class="ph codeph">pg_hba.conf</samp> files after making
        configuration changes but do not shutdown the HAWQ array:</p>
<pre class="pre codeblock">gpstop -u</pre>
</div>
<div class="section" id="topic1__section6"><h2 class="title sectiontitle">See Also</h2><p class="p"><samp class="ph codeph"><a class="xref" href="gpstart.html">gpstart</a></samp></p>
</div>
</div>
<div class="related-links"/>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../topics/ManagementUtilityReference.html" title="Management Utility Reference"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Management Utility Reference</span></a></span>  </div><div>
<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
      <a href="http://docs.pivotal.io" target="_blank">Pivotal Documentation</a>
      © 2014 <a href="http://www.pivotal.io/" target="_blank">Pivotal Software</a>, Inc. All Rights Reserved.
  </div>
  <div class="support">
    Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
   </div>
  </footer>
</div><!--end of container-->
</div>
</body>
</html>