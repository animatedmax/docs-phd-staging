
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head><meta xmlns="http://www.w3.org/1999/xhtml" name="description" content="Upgrades an existing HAWQ 1.1.x system to 1.2.x. Synopsis gpmigrator old_GPHOME_path new_GPHOME_path            [ -d master_data_directory ]            [ -l logfile_directory ] [ -q ] [ --debug ] ..."/><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta name="copyright" content="(C) Copyright 2005"/><meta name="DC.rights.owner" content="(C) Copyright 2005"/><meta name="DC.Type" content="topic"/><meta name="DC.Title" content="gpmigrator"/><meta name="DC.Relation" scheme="URI" content="../topics/ManagementUtilityReference.html"/><meta name="prodname" content=""/><meta name="version" content="2.1.0"/><meta name="release" content=""/><meta name="modification" content=""/><meta name="DC.Format" content="XHTML"/><meta name="DC.Identifier" content="topic1"/><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>gpmigrator</title><meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Type" content="text/html; charset=utf-8"><!----></meta><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/commonltr.css"><!----></link><link xmlns="http://www.w3.org/1999/xhtml" rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../oxygen-webhelp/resources/css/pivotal.css"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript"><!--
          
          var prefix = "../index.html";
          
          --></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" src="../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" charset="utf-8" src="../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" id="topic1"><script xmlns="http://www.w3.org/1999/xhtml" src="//use.typekit.net/clb0qji.js" type="text/javascript"/><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  try {
				  Typekit.load();
			  } catch (e) {
			  }
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			  document.domain = "pivotal.io";
		  </script><script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
			WebFontConfig = {
			  google: { families: [ 'Source+Sans+Pro:300italic,400italic,300,400,600:latin' ] }
			};
			(function() {
			  var wf = document.createElement('script');
			  wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
				'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
			  wf.type = 'text/javascript';
			  wf.async = 'true';
			  var s = document.getElementsByTagName('script')[0];
			  s.parentNode.insertBefore(wf, s);
			})();
		  </script>
<table class="nav"><tbody><tr><td colspan="2"><div id="permalink"><a href="#" title="Link to this page"/></div><div id="printlink"><a href="javascript:window.print();" title="Print this page"/></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="../topics/../topics/HAWQAdministration.html" title="HAWQ Administration">HAWQ Administration</a> / <a class="navheader_parent_path" href="../topics/ManagementUtilityReference.html" title="Management Utility Reference">Management Utility Reference</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="../topics/ManagementUtilityReference.html" title="Management Utility Reference"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Management Utility Reference</span></a></span>  </div></td></tr></tbody></table>

  <h1 class="title topictitle1">gpmigrator</h1>

  <div class="body">
    <p class="p">Upgrades an existing HAWQ 1.1.x system to 1.2.x.</p>

    <div class="section" id="topic1__section2"><h2 class="title sectiontitle">Synopsis</h2>
      
      <pre class="pre codeblock"><strong class="ph b">gpmigrator</strong> <var class="keyword varname">old_GPHOME_path</var> <var class="keyword varname">new_GPHOME_path</var>
           [<strong class="ph b">-d</strong> <var class="keyword varname">master_data_directory</var>] 
           [<strong class="ph b">-l</strong> <var class="keyword varname">logfile_directory</var>] [<strong class="ph b">-q</strong>] [<strong class="ph b">--debug</strong>] 
           [<strong class="ph b">--check-only</strong>] [<strong class="ph b">-R</strong>]

<strong class="ph b">gpmigrator</strong> <strong class="ph b">--version</strong> | <strong class="ph b">-v</strong> 

<strong class="ph b">gpmigrator</strong> <strong class="ph b">--help</strong> | <strong class="ph b">-h</strong></pre>

    </div>

    <div class="section" id="topic1__section3"><h2 class="title sectiontitle">Prerequisites</h2>
      
      <p class="p">The following tasks should be performed prior to executing an upgrade:</p>

      <ul class="ul">
        <li class="li" id="topic1__kz140057">Make sure you are logged in to the master host as the HAWQ superuser
            (<samp class="ph codeph">gpadmin</samp>).</li>

        <li class="li" id="topic1__kz140828">Install the HAWQ 1.2 binaries on all HAWQ hosts.</li>

        <li class="li" id="topic1__kz142587">Copy or preserve any additional folders or files (such as backup folders)
          that you have added in the HAWQ data directories or <samp class="ph codeph">$GPHOME</samp> directory.
          Only files or folders strictly related to HAWQ operations are preserved by the migration
          utility.</li>

        <li class="li" id="topic1__kz142588">(<strong class="ph b">Optional</strong>) Run <samp class="ph codeph">VACUUM</samp> on all databases, and remove
          old server log files from <samp class="ph codeph">pg_log</samp> in your master and segment data
          directories. This is not required, but will reduce the size of HAWQ files to be backed up
          and migrated.</li>

        <li class="li" id="topic1__kz140747">Check for and recover any failed segments in your current HAWQ system
            (<samp class="ph codeph">gpstate</samp>, <samp class="ph codeph">gprecoverseg</samp>).</li>

        <li class="li" id="topic1__kz142626">(<strong class="ph b">Optional, but highly recommended</strong>) Back up your current databases.
          If you find any issues when testing your upgraded system, you can restore this
          backup.</li>

        <li class="li" id="topic1__kz141594">Remove the standby master from your system configuration
            (<samp class="ph codeph">gpinitstandby -r</samp>).</li>

        <li class="li" id="topic1__kz140080">Do a clean shutdown of your current system (<samp class="ph codeph">gpstop</samp>).</li>

        <li class="li" id="topic1__kz140669">Update your environment to source the 1.2 installation.</li>

        <li class="li" id="topic1__kz140852">Inform all database users of the upgrade and lockout time frame. Once the
          upgrade is in process, users will not be allowed on the system until the upgrade is
          complete.</li>

      </ul>

    </div>

    <div class="section" id="topic1__section4"><h2 class="title sectiontitle">Description</h2>
      
      <p class="p">The <samp class="ph codeph">gpmigrator</samp> utility upgrades an existing Greenplum Database 1.1.x
        system to 1.2.x. This utility updates the system catalog and internal version number, but
        not the actual software binaries. During the migration process, all client connections to
        HAWQ will be locked out.</p>

    </div>

    <div class="section" id="topic1__section5"><h2 class="title sectiontitle">Options</h2>
      
      <dl class="dl parml">
        
          <dt class="dt pt dlterm">
            <var class="keyword varname">old_GPHOME_path</var>
          </dt>

          <dd class="dd pd">Required. The absolute path to the current version of HAWQ software you want to
            migrate away from.</dd>

        
        
          <dt class="dt pt dlterm">
            <var class="keyword varname">new_GPHOME_path</var>
          </dt>

          <dd class="dd pd">Required. The absolute path to the new version of HAWQ software you want to migrate
            to.</dd>

        
        
          <dt class="dt pt dlterm">-d <var class="keyword varname">master_data_directory</var></dt>

          <dd class="dd pd">Optional. The current master host data directory. If not specified, the value set for
              <samp class="ph codeph">$MASTER_DATA_DIRECTORY</samp> will be used.</dd>

        
        
          <dt class="dt pt dlterm">-l <var class="keyword varname">logfile_directory</var></dt>

          <dd class="dd pd">The directory to write the log file. Defaults to
            <span class="ph filepath">~/gpAdminLogs</span>.</dd>

        
        
          <dt class="dt pt dlterm">-q (quiet mode)</dt>

          <dd class="dd pd">Run in quiet mode. Command output is not displayed on the screen, but is still written
            to the log file.</dd>

        
        
          <dt class="dt pt dlterm">-R (revert)</dt>

          <dd class="dd pd">In the event of an error during upgrade, reverts all changes made by
              <samp class="ph codeph">gpmigrator</samp>.</dd>

        
        
          <dt class="dt pt dlterm">--check-only</dt>

          <dd class="dd pd">Runs pre-migrate checks to verify that your database is healthy.</dd>

          <dd class="dd pd">Checks include: <ul class="ul" id="topic1__ul_ldz_4rm_z4">
              <li class="li">Check catalog health</li>

              <li class="li">Check that the Greenplum Database binaries on each segment match those on the
                master</li>

              <li class="li">Check for a minimum amount of free disk space</li>

            </ul>
<p class="p">Performing a pre-migration check of your database should be done during a
              database maintenance period. If the utility detects catalog errors, the utility stops
              the database.</p>
</dd>

        
        
          <dt class="dt pt dlterm">--help | -h</dt>

          <dd class="dd pd">Displays the online help.</dd>

        
        
          <dt class="dt pt dlterm">--debug</dt>

          <dd class="dd pd">Sets logging level to debug.</dd>

        
        
          <dt class="dt pt dlterm">--version | -v</dt>

          <dd class="dd pd">Displays the version of this utility. </dd>

        
      </dl>

    </div>

    <div class="section" id="topic1__section7"><h2 class="title sectiontitle">See Also</h2>
      
      <p class="p"><samp class="ph codeph"><a class="xref" href="gpstop.html#topic1">gpstop</a></samp>,
            <samp class="ph codeph"><a class="xref" href="gpstate.html#topic1">gpstate</a></samp>,
            <samp class="ph codeph"><a class="xref" href="gprecoverseg.html#topic1">gprecoverseg</a></samp></p>

    </div>

  </div>

<div class="related-links"/>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="../topics/ManagementUtilityReference.html" title="Management Utility Reference"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Management Utility Reference</span></a></span>  </div><div>
<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
      <a href="http://docs.pivotal.io" target="_blank">Pivotal Documentation</a>
      © 2014 <a href="http://www.pivotal.io/" target="_blank">Pivotal Software</a>, Inc. All Rights Reserved.
  </div>
  <div class="support">
    Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
   </div>
  </footer>
</div><!--end of container-->
</div>
</body>
</html>